<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Da Aloo - Menu</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Montserrat:wght@400;500;600;700;800&family=Poppins:wght@300;400;500;600;700&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <header class="site-header">
        <div class="container">
            <div class="header-content">
                <div class="logo-section">
                    <div class="logo-container">
                        <img src="images/logo.png" alt="Da Aloo Logo" class="main-logo">
                        <div class="tagline">"Where Hunger Comes to An End"</div>
                    </div>
                    <nav class="site-nav">
                        <a href="index.html" class="nav-link">Menu</a>
                        <a href="offers.html" class="nav-link">Offers</a>
                        <a href="about.html" class="nav-link">About</a>
                    </nav>
                </div>
            </div>
        </div>
    </header>

    <main>
        <section class="menu-section">
            <div class="container">
                <div class="menu-header">
                    <h1 class="section-title menu-page-title">Our Menu</h1>
                    <button class="save-menu-btn" id="saveMenuBtn">
                        <i class="fas fa-file-pdf"></i> Save Menu
                    </button>
                </div>

                <div class="cart-container">
                    <div class="cart-icon" id="cartIcon">
                        <i class="fas fa-shopping-cart"></i>
                        <span class="cart-badge" id="cartBadge">0</span>
                    </div>
                </div>

                <div class="category-tabs" id="categoryTabs">
                </div>

                <div class="menu-items-grid" id="menuItems">
                </div>
            </div>
        </section>
    </main>

    <div class="cart-modal" id="cartModal">
        <div class="cart-modal-content">
            <div class="cart-modal-header">
                <h2>Your Order</h2>
                <span class="close-cart" id="closeCart">&times;</span>
            </div>
            <div class="cart-items" id="cartItems">
                <div class="empty-cart-message" id="emptyCartMessage">
                    <i class="fas fa-shopping-cart"></i>
                    <p>Your cart is empty</p>
                </div>
            </div>
            <div class="cart-total" id="cartTotal">
                Total: Rs 0
            </div>
            <div class="cart-actions">
                <button class="checkout-btn" id="checkoutBtn" style="width: 100%; background-color: #4CAF50;">
                    <i class="fas fa-map-marker-alt"></i> SELECT DELIVERY LOCATION
                </button>
            </div>
        </div>
    </div>

    <div class="customization-modal" id="customizationModal">
        <div class="customization-modal-content">
            <div class="customization-header">
                <h3 id="customizationItemName">Select Variant</h3>
                <span class="close-customization" id="closeCustomization">&times;</span>
            </div>
            <div class="customization-body" id="customizationBody">
            </div>
            <div class="customization-actions">
                <button class="cancel-customization" id="cancelCustomization">Cancel</button>
                <button class="add-to-cart-custom" id="addToCartCustom">Add to Cart - Rs <span
                        id="customTotalPrice">0</span></button>
            </div>
        </div>
    </div>

    <footer class="site-footer">
        <div class="container">
            <p>&copy; <span id="currentYear"></span> Da Aloo. All rights reserved.</p>
        </div>
    </footer>

    <a class="floating-whatsapp" href="tel:+9779847375984">
        <i class="fas fa-phone-alt"></i> Call Now
    </a>

    <div class="save-notification" id="saveNotification">
        <div class="notification-content">
            <i class="fas fa-check-circle"></i>
            <span>Menu image downloaded successfully!</span>
        </div>
    </div>

    <script>
        // Menu data
        const MENU = {
            "Aloo Fries": [
                { "name": "Aloo Fries Medium", "price": 70 },
                { "name": "Aloo Fries Large", "price": 130 },
                { "name": "Cajun & Garlic Fries", "price": 150 },
                { "name": "Chili Fries", "price": 160 },
                { "name": "Spicy Buff Sausage Fries", "price": 160 },
                { "name": "Cheesy Fries", "price": 170 },
                { "name": "Chicken Makhani Fries", "price": 190 },
            ],
            "Da Aloo Special": [
                { "name": "Battered Fries", "price": 180 },
                { "name": "Fried Pizza Ball", "price": 180 },
            ],
            "Spirals": [
                { "name": "Aloo's Spiral", "price": 60, "extras": [{ "name": "Extra Sauce", "price": 20 }] },
                { "name": "Cheesy Spiral", "price": 80, "extras": [{ "name": "Extra Sauce", "price": 20 }] },
                { "name": "Battered Spiral", "price": 80, "extras": [{ "name": "Extra Sauce", "price": 20 }] },
            ],
            "Katti Roll": [
                { "name": "Aloo Chat Katti Roll", "price": 120, "extras": [{ "name": "Add Egg", "price": 30 }] },
                { "name": "Spicy Buff Sausage Katti Roll", "price": 160, "extras": [{ "name": "Add Egg", "price": 30 }] },
                { "name": "Paneer Katti Roll", "price": 160, "extras": [{ "name": "Add Egg", "price": 30 }] },
                { "name": "Tandoori Chicken Katti Roll", "price": 180, "extras": [{ "name": "Add Egg", "price": 30 }] },
            ],
            "Mo:Mo": [
                { "name": "Aloo Mo:Mo", "variants": [{ "name": "Steam", "price": 100 }, { "name": "Kothey", "price": 120 }, { "name": "Fried", "price": 130 }, { "name": "Jhol", "price": 140 }, { "name": "Chilli", "price": 150 }] },
                { "name": "Paneer Mo:Mo", "variants": [{ "name": "Steam", "price": 130 }, { "name": "Kothey", "price": 140 }, { "name": "Fried", "price": 150 }, { "name": "Jhol", "price": 160 }, { "name": "Chilli", "price": 180 }] },
                { "name": "Buff Mo:Mo", "variants": [{ "name": "Steam", "price": 130 }, { "name": "Kothey", "price": 140 }, { "name": "Fried", "price": 150 }, { "name": "Jhol", "price": 160 }, { "name": "Chilli", "price": 180 }] },
                { "name": "Chicken Mo:Mo", "variants": [{ "name": "Steam", "price": 150 }, { "name": "Kothey", "price": 160 }, { "name": "Fried", "price": 170 }, { "name": "Jhol", "price": 180 }, { "name": "Chilli", "price": 190 }] },
            ],
            "Burger": [
                { "name": "Aloo Tikki Burger", "price": 160, "extras": [{ "name": "Add Cheese", "price": 50 }] },
                { "name": "Chicken Burger", "price": 220, "extras": [{ "name": "Add Cheese", "price": 50 }] },
                { "name": "Spicy Buff Burger", "price": 210, "extras": [{ "name": "Add Cheese", "price": 50 }] },
            ],
            "Sandwich": [
                { "name": "Veg Sandwich", "price": 140 },
                { "name": "Chicken Sandwich", "price": 180 },
            ],
            "Keema Noodles": [
                { "name": "Paneer Keema Noodles", "price": 180 },
                { "name": "Chicken Keema Noodles", "price": 200 },
                { "name": "Buff Keema Noodles", "price": 180 },
            ],
            "Fried Rice": [
                { "name": "Veg Fried Rice", "price": 120 },
                { "name": "Chicken Fried Rice", "price": 180 },
                { "name": "Buff Fried Rice", "price": 160 },
                { "name": "Mixed Fried Rice", "price": 200 },
            ],
            "Chowmein": [
                { "name": "Veg Chowmein", "price": 110 },
                { "name": "Chicken Chowmein", "price": 170 },
                { "name": "Buff Chowmein", "price": 150 },
                { "name": "Mixed Chowmein", "price": 190 },
            ],
            "Snacks": [
                { "name": "Chicken Chilly", "price": 250 },
                { "name": "Buff Chilly", "price": 240 },
                { "name": "Paneer Chilly", "price": 240 },
                { "name": "Chicken Sausage Chilly", "price": 190 },
                { "name": "Buff Sausage Chilly", "price": 180 },
                { "name": "Sausage", "price": 50, "variants": [{ "name": "Buff", "price": 50 }, { "name": "Chicken", "price": 60 }] },
                { "name": "Chicken Nuggets", "price": 250 },
            ],
            "Chicken Wings": [
                { "name": "Buffalo Hot Wings", "price": 330, "details": "3 pcs" },
                { "name": "Crunchy Wings", "price": 330, "details": "3 pcs" },
                { "name": "Cheesy Garlic Wings", "price": 350, "details": "3 pcs" },
            ],
            "Rice or Roti Meal": [
                { "name": "Butter Chicken Curry", "price": 210, "extras": [{ "name": "With Rice", "price": 0 }, { "name": "With Roti", "price": 0 }] },
                { "name": "Tandoori Chicken Curry", "price": 200, "extras": [{ "name": "With Rice", "price": 0 }, { "name": "With Roti", "price": 0 }] },
                { "name": "Masala Paneer Curry", "price": 200, "extras": [{ "name": "With Rice", "price": 0 }, { "name": "With Roti", "price": 0 }] },
                { "name": "Aloo Curry", "price": 160, "extras": [{ "name": "With Rice", "price": 0 }, { "name": "With Roti", "price": 0 }] },
            ],
            "Cold Drinks": [
                { "name": "Coke / Fanta / Sprite", "price": 70 },
                { "name": "Cold Coffee", "price": 120 },
                { "name": "Ice Mint Lemonade", "price": 140 },
                { "name": "Green Apple Mojito", "price": 150 },
                { "name": "Blue Lagoon", "price": 160 },
                { "name": "Peach Ice Tea", "price": 160 },
                { "name": "Strawberry Lemonade", "price": 160 },
                { "name": "Sweet Lassi", "price": 100 },
            ],
            "Hot Drinks": [
                { "name": "Masala Black Tea", "price": 30 },
                { "name": "Masala Milk Tea", "price": 50 },
                { "name": "Lemon Tea", "price": 40 },
                { "name": "Suja (Butter Milk Tea)", "price": 70 },
                { "name": "Hot Lemon", "price": 70 },
                { "name": "Americano", "price": 80 },
                { "name": "Cappuccino", "price": 100 },
                { "name": "Hot Chocolate", "price": 100 },
            ]
        };

        const categoryImages = {
            "Aloo Fries": "images/categories/aloo-fries.jpg",
            "Da Aloo Special": "images/categories/special.jpg",
            "Spirals": "images/categories/spirals.jpg",
            "Katti Roll": "images/categories/katti-roll.jpg",
            "Mo:Mo": "images/categories/momo.jpg",
            "Burger": "images/categories/burger.jpg",
            "Sandwich": "images/categories/sandwich.jpg",
            "Keema Noodles": "images/categories/keema-noodles.jpg",
            "Fried Rice": "images/categories/fried-rice.jpg",
            "Chowmein": "images/categories/chowmein.jpg",
            "Snacks": "images/categories/snacks.jpg",
            "Chicken Wings": "images/categories/chicken-wings.jpg",
            "Rice or Roti Meal": "images/categories/rice-roti.jpg",
            "Cold Drinks": "images/categories/cold-drinks.jpg",
            "Hot Drinks": "images/categories/hot-drinks.jpg"
        };

        let cart = [];
        let currentCustomizationItem = null;

        // Initialize App
        document.addEventListener('DOMContentLoaded', () => {
            loadCart();
            generateCategoryTabs();
            generateMenuItems();
            setupTabSwitching();
            setupSaveMenuButton();
            setupCart();
            setupCustomizationModal();
            updateCartBadge();
            document.getElementById('currentYear').textContent = new Date().getFullYear();
        });

        function loadCart() {
            const savedCart = localStorage.getItem('daAlooCart');
            if (savedCart) cart = JSON.parse(savedCart);
        }

        function saveCart() {
            localStorage.setItem('daAlooCart', JSON.stringify(cart));
        }

        function generateCategoryTabs() {
            const tabsContainer = document.getElementById('categoryTabs');
            Object.keys(MENU).forEach((categoryName, index) => {
                const tabId = categoryName.toLowerCase().replace(/[ &\/]/g, '-');
                const button = document.createElement('button');
                button.className = `category-tab ${index === 0 ? 'active' : ''}`;
                button.setAttribute('data-category', tabId);
                button.innerHTML = `
                    <div class="tab-content">
                        <div class="tab-image"><img src="${categoryImages[categoryName]}" alt="${categoryName}"></div>
                        <span class="tab-text">${categoryName}</span>
                    </div>`;
                tabsContainer.appendChild(button);
            });
        }

        function generateMenuItems() {
            const menuContainer = document.getElementById('menuItems');
            Object.entries(MENU).forEach(([categoryName, items], index) => {
                const categoryId = categoryName.toLowerCase().replace(/[ &\/]/g, '-');
                const categoryDiv = document.createElement('div');
                categoryDiv.className = `category-content ${index === 0 ? 'active' : ''}`;
                categoryDiv.id = categoryId;

                let itemsHTML = '';
                items.forEach(item => {
                    const hasVariants = item.variants && item.variants.length > 0;
                    itemsHTML += `
                        <div class="menu-item-card">
                            <div class="item-main-container">
                                <div class="item-left"><h3 class="item-name">${item.name}</h3></div>
                                <div class="item-right"><div class="item-price">Rs ${item.price || item.variants[0].price}</div></div>
                            </div>
                            <button class="add-to-cart-btn ${hasVariants ? 'customize-btn' : ''}" 
                                    data-name="${item.name}" data-price="${item.price || 0}" 
                                    data-has-variants="${hasVariants}">
                                <i class="fas fa-${hasVariants ? 'list-ul' : 'plus'}"></i> 
                                ${hasVariants ? 'Choose Variant' : 'Add to Cart'}
                            </button>
                        </div>`;
                });
                categoryDiv.innerHTML = `<div class="category-header"><h2 class="category-title">${categoryName}</h2></div><div class="category-items">${itemsHTML}</div>`;
                menuContainer.appendChild(categoryDiv);
            });
        }

        function setupTabSwitching() {
            document.querySelectorAll('.category-tab').forEach(tab => {
                tab.addEventListener('click', () => {
                    document.querySelectorAll('.category-tab').forEach(t => t.classList.remove('active'));
                    document.querySelectorAll('.category-content').forEach(c => c.classList.remove('active'));
                    tab.classList.add('active');
                    document.getElementById(tab.getAttribute('data-category')).classList.add('active');
                });
            });
        }

        function setupCart() {
            const cartIcon = document.getElementById('cartIcon');
            const cartModal = document.getElementById('cartModal');
            const closeCart = document.getElementById('closeCart');
            const checkoutBtn = document.getElementById('checkoutBtn');

            cartIcon.addEventListener('click', () => { cartModal.style.display = 'block'; updateCartDisplay(); });
            closeCart.addEventListener('click', () => { cartModal.style.display = 'none'; });

            // REDIRECT TO LOCATION PAGE LOGIC
            checkoutBtn.addEventListener('click', () => {
                if (cart.length === 0) {
                    alert('Your cart is empty!');
                    return;
                }
                // Save cart before leaving
                saveCart();
                // Move to location.html
                window.location.href = 'location.html';
            });
        }

        function updateCartBadge() {
            const count = cart.reduce((sum, item) => sum + item.quantity, 0);
            document.getElementById('cartBadge').textContent = count;
        }

        function updateCartDisplay() {
            const container = document.getElementById('cartItems');
            const totalEl = document.getElementById('cartTotal');
            if (cart.length === 0) {
                container.innerHTML = '<div class="empty-cart-message"><p>Your cart is empty</p></div>';
                totalEl.textContent = 'Total: Rs 0';
                return;
            }

            let html = '';
            let total = 0;
            cart.forEach((item, index) => {
                html += `
                    <div class="cart-item">
                        <div><strong>${item.name}</strong> ${item.variant ? `(${item.variant.name})` : ''}</div>
                        <div>Rs ${item.totalPrice} 
                            <button onclick="removeFromCart(${index})" style="margin-left:10px; color:red; border:none; background:none; cursor:pointer;"><i class="fas fa-trash"></i></button>
                        </div>
                    </div>`;
                total += item.totalPrice;
            });
            container.innerHTML = html;
            totalEl.textContent = `Total: Rs ${total}`;
        }

        function addToCart(name, price, variant = null) {
            const existing = cart.find(i => i.name === name && JSON.stringify(i.variant) === JSON.stringify(variant));
            if (existing) {
                existing.quantity++;
                existing.totalPrice = existing.quantity * price;
            } else {
                cart.push({ name, basePrice: price, variant, quantity: 1, totalPrice: price });
            }
            saveCart();
            updateCartBadge();
            alert(`${name} added to cart!`);
        }

        function removeFromCart(index) {
            cart.splice(index, 1);
            saveCart();
            updateCartBadge();
            updateCartDisplay();
        }

        function setupCustomizationModal() {
            const modal = document.getElementById('customizationModal');
            document.addEventListener('click', (e) => {
                if (e.target.classList.contains('add-to-cart-btn')) {
                    const name = e.target.getAttribute('data-name');
                    const hasVariants = e.target.getAttribute('data-has-variants') === 'true';
                    if (hasVariants) {
                        currentCustomizationItem = findMenuItem(name);
                        openModal(currentCustomizationItem);
                    } else {
                        addToCart(name, parseInt(e.target.getAttribute('data-price')));
                    }
                }
            });

            document.getElementById('addToCartCustom').addEventListener('click', () => {
                const selected = document.querySelector('input[name="variant"]:checked');
                if (selected) {
                    addToCart(currentCustomizationItem.name, parseInt(selected.dataset.price), { name: selected.value });
                    modal.style.display = 'none';
                }
            });

            document.getElementById('closeCustomization').onclick = () => modal.style.display = 'none';
            document.getElementById('cancelCustomization').onclick = () => modal.style.display = 'none';
        }

        function openModal(item) {
            const body = document.getElementById('customizationBody');
            let html = '';
            item.variants.forEach((v, i) => {
                html += `<label style="display:block; margin:10px 0;"><input type="radio" name="variant" value="${v.name}" data-price="${v.price}" ${i === 0 ? 'checked' : ''}> ${v.name} - Rs ${v.price}</label>`;
            });
            body.innerHTML = html;
            document.getElementById('customizationItemName').textContent = item.name;
            document.getElementById('customTotalPrice').textContent = item.variants[0].price;
            document.getElementById('customizationModal').style.display = 'block';
        }

        function findMenuItem(name) {
            for (let cat in MENU) {
                let item = MENU[cat].find(i => i.name === name);
                if (item) return item;
            }
        }

        function setupSaveMenuButton() {
            document.getElementById('saveMenuBtn').addEventListener('click', () => {
                const link = document.createElement('a');
                link.href = 'images/menu.jpg';
                link.download = 'da-aloo-menu.jpg';
                link.click();
            });
        }
    </script>
</body>

</html>